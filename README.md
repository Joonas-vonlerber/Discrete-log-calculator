# Discrete log calculator

A library for calculating discrete logs in $\mathbb{Z}_n^\times$ for arbitary $n$ using the [silver-pohlig-hellman algorithm](https://en.wikipedia.org/wiki/Pohlig%E2%80%93Hellman_algorithm). This is a python script with a simple collection of helper functions to help the crypto-ctf people in need.

## Guide to using pohlig-hallman

- Indentify the discrete log problem that you want to solve. Which group does it use? Which modulo does it operate in and what generator does it use.
- Check if the modulo is prime. How many bits is the modulo. What other properties does the modulo have? For example is the modulo a prime power?
- Investigate the order of the generator. By lagranges theorem the order of the generator divides the order of the group. The order of the group is $\varphi(n)$ where $\varphi$ is the [Euler totient function](https://en.wikipedia.org/wiki/Euler%27s_totient_function). The order of the generator is at most $\lambda(n)$ in which $\lambda$ is the [carmichael function](https://en.wikipedia.org/wiki/Carmichael_function). One can calculate the order of the generator by `mult_order_element` and one can check whether the order of the generator is $\lambda(n)$ or $\varphi(n)$ by using functions `is_lambda_primite_root_mod_n` and `is_primitive_root_mod_n`.

From these facts one can determine whether the problem can be solved in a reasonable amount of time. For example: If the order of the generated group is a prime larger than $32$ bits, solving might take a lot of time.

Pohlig-hellman requires the user to give the group, the input to the log, the generator of the group or sometimes called the base of the logarithm and the order of the generator.

### Example

Example on using pohlig-hellman algorithm on group $\mathbb{Z}_{1807}^\times$ with generator $5$ to calculate the discrete log of $116$. The subgroup generated by $5$ has order $276$:

```python
dlog = pohlig_hellman(116, 5, 1807, 276)
assert pow(5, dlog, 1807) == 116
```

Optionally when the factorization of the order is known, as it might take too long to compute in some cases,
one can give the factorization as an optional argument to the function to avoid calculating it.

```python
dlog = pohlig_hellman(116, 5, 1807, 276, [(2,2), (3,1), (23,1)])
assert pow(5, dlog, 1807) == 116
```
